# Forecast of COVID-19 Daily New Cases On U.S State Level
**Through Integrated Methods of Machine Learning Models and Arima Models**


[https://share.streamlit.io/puzeng/biostat823_final_project_streamlit/main/Streamlit_Dashboard.py](Dashboard Link)

*Contributors:*  

*Xige Huang:* *2nd MS student in Department of Statistical Science, Duke University*

*Gaojia Xu:*     *2nd MS student in Department of Statistical Science, Duke University*

*Pu Zeng:*       *2nd MB student in Department of Biostatistics and Bioinformatics, Duke University*  




### Dashboard introduction

In order to showcase the predicted and forecasted new cases, we designed a dashboard by allowing users to look at covid data in different states and save images of own choices.  

The dashboard is consist of two sections.  

The first section is about exploring the trend of cumulative and new cases in the date range between `2020-03-02` to `2021-11-05`. Meanwhile, due to quite a number of variables included in the dataset, the dashboard contained variable descriptions in the side bar for users to look up.  

The second section is for presenting the predicted and forecasted new cases which were generated by the integrated methodology in machine learning and ARIMA models. In addition, within the prediction and forecasting section, results from machine learning models could all be observed at the same line plot that different models were represented by different colors and the modeled resulst could be compared relative to the true values.  


## Abstract

We have all witnessed the rise and fall of Covid-19 cases during the last two years. It is clearly a challege to predict case numbers using statistical models due to a lot of unobservable factors that are correlated with outburst of a padenmic. In this project, we attempt to forecast the daily new case number by iteratively using AutoRegressive Integrated Moving Average (ARIMA) Models and a choice of three maching learning models. Specifically, we use seperate ARIMA models to predict the values of a set of time series predictors, and then input the predicted values along with a set of static predictors into the machine learning models to forecast the new case numbers. We use 21 days starting from `2021-10-16` as the prediction interval for model comparison and selection, and the following 28 days starting from `2021-11-06` to do forecast. Our findings includes that the three machine learning models we implemented (random forest, extreme gradient boosting (XGBoost), and gradient boosting machines(GBM)) performs similarly in the prediction of case numbers; this corresponds to the conclusion drawn by various previous researches, the machine learning models may not perform as well as some classical time series models in such prediction settings.

## Data Overview

This project uses the Covid-19 open data _need footnote_ from `Google Cloud Platform`[1]. Since the data contains daily record of variables from `2020-01-01` to the point of this project, `2021-11-05`, and is pretty large, we run SQL queries on the Google Cloud Platform to fetch the data. The Covid-19 open data set contains variables of demographic, geography, economy, weather, mobility, epidemiology, emergency declarations, government response, health indicators, hospitalizations, search trends in google search of symptoms volumns due to Covid-19, vaccination, vaccination search, and vaccination access on U.S. county level.  

Among these tables we do not use vaccination data (trends in persons vaccinated and population vaccination rate), vaccination search (trends in Google searches for COVID-19 vaccination information), and vaccination access (metrics quantifying access to COVID-19 vaccination sites). The first reason is that the first Covid-19 vaccines were distributed in `December, 2020`, therefore we would have to only use other variables from after `December, 2020`. However, in our initial model building process, we found out that the loss of a huge number of observations if vaccine data are included will lead to a huge reduction of prediction accuracy. Therefore, we choose to use all variables with values from `2020-01-01` but exclude the vaccine information.
 
 
 ## Models

We use integrated methods of ARIMA models and machine learning models to forecast the daily new cases. First, we train separate ARIMA models for each time series predictors for each state, and then predict the values of each predictors for each date. Next, we use the predicted values of the time series predictors along with other static predictors as input of the machine learning models to do prediction and forecast.
 
 
